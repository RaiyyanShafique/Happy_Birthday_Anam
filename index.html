<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Birthday Anmu! 🎂</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for decoration and effects */
        @import url('https://fonts.googleapis.com/css2?family=Pacifico&family=Inter:wght@400;700;900&display=swap');

        :root {
            --primary-pink: #ff69b4;
            --secondary-gold: #ffd700;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #fce4ec 0%, #ffebee 100%);
            overflow-x: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .title-font {
            font-family: 'Pacifico', cursive;
            color: var(--primary-pink);
            text-shadow: 2px 2px 0 #fff, 4px 4px 0 var(--secondary-gold);
        }

        .decorative-card {
            background-color: #fff;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.25), 0 0 15px rgba(255, 105, 180, 0.8);
            border-radius: 20px;
            border: 5px solid var(--secondary-gold);
            animation: pulse 4s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 15px 30px rgba(0, 0, 0, 0.25), 0 0 15px rgba(255, 105, 180, 0.8); }
            50% { transform: scale(1.02); box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3), 0 0 25px rgba(255, 215, 0, 1); }
            100% { transform: scale(1); box-shadow: 0 15px 30px rgba(0, 0, 0, 0.25), 0 0 15px rgba(255, 105, 180, 0.8); }
        }

        /* --- Candle Animation --- */
        .candle {
            position: relative;
            width: 30px;
            height: 100px;
            background: linear-gradient(to top, #fff 0%, #ccc 100%);
            border-radius: 5px;
            margin: 0 15px;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.5);
        }

        .wick {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 2px;
            height: 15px;
            background: #222;
        }

        .flame {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            width: 10px;
            height: 20px;
            background-color: orange;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            box-shadow: 0 0 5px yellow, 0 0 10px orange, 0 0 15px red;
            animation: flicker 0.1s infinite alternate;
        }

        @keyframes flicker {
            0% { transform: translateX(-50%) scale(1.0); opacity: 1; }
            50% { transform: translateX(-50%) scale(0.95); opacity: 0.95; }
            100% { transform: translateX(-50%) scale(1.05); opacity: 1; }
        }

        /* --- Confetti/Firework Particles (Realistic) --- */
        .confetti {
            position: fixed; /* Fixed position allows particles to fly across the entire viewport */
            opacity: 0;
            pointer-events: none;
            transition: none;
            will-change: transform, opacity;
        }
        .confetti.round {
            border-radius: 50%;
        }
        .confetti.strip {
            border-radius: 1px;
        }

        .fireworks-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 50;
        }
    </style>
</head>
<body class="p-4 md:p-8">
    <!-- Confetti & Fireworks Container (for Page 3) -->
    <div id="fireworks-container" class="fireworks-container"></div>

    <div id="app-container" class="w-full max-w-lg mx-auto text-center decorative-card p-6 md:p-10 transition-all duration-500 min-h-[400px]">
        <!-- Content will be rendered here by JavaScript -->
    </div>

    <script>
        // --- Global Variables ---
        let currentPage = 1;
        const totalPages = 3;
        const appContainer = document.getElementById('app-container');
        const fireworksContainer = document.getElementById('fireworks-container');

        const friendName = "Anam Irfan";
        const nickname = "Anmu";
        const birthdayDate = new Date('October 20, 2025 00:00:00'); // Assuming a general future date for the demo

        // --- Utility Functions (Enhanced Confetti) ---

        // Function to create and launch a single confetti particle
        function createConfetti(x, y, color, size, shape, container) {
            const particle = document.createElement('div');

            if (shape === 'strip') {
                particle.className = 'confetti strip';
                particle.style.width = `${size * 2}px`;
                particle.style.height = `${size * 0.5}px`;
            } else {
                particle.className = 'confetti round';
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
            }

            particle.style.backgroundColor = color;
            particle.style.left = `${x}px`;
            particle.style.top = `${y}px`;
            particle.style.opacity = 1;

            const angle = Math.random() * Math.PI * 2;
            const velocity = Math.random() * 50 + 20; // Increased velocity for better pop
            const lifetime = Math.random() * 2500 + 1500; // Longer lifetime
            const rotationSpeed = Math.random() * 0.2 - 0.1; // Natural rotation

            const dx = Math.cos(angle) * velocity;
            const dy = Math.sin(angle) * velocity - 30; // Strong initial upward bias

            container.appendChild(particle);

            let startTime = performance.now();

            function animateConfetti(currentTime) {
                const elapsedTime = currentTime - startTime;
                if (elapsedTime > lifetime) {
                    particle.remove();
                    return;
                }

                const timeRatio = elapsedTime / 1000;
                // Position update based on time, velocity, and gravity (simplified)
                const currentX = x + dx * timeRatio;
                const currentY = y + dy * timeRatio + 0.5 * 9.8 * timeRatio * timeRatio * 50;

                // Opacity fades out towards the end of lifetime
                const opacity = 1 - (elapsedTime / lifetime);

                // Apply translation and rotation
                particle.style.transform = `translate(${currentX - x}px, ${currentY - y}px) rotate(${elapsedTime * rotationSpeed}deg)`;
                particle.style.opacity = opacity;

                requestAnimationFrame(animateConfetti);
            }
            requestAnimationFrame(animateConfetti);
        }

        // Function to simulate a "pop" of confetti from a point
        function launchConfettiBurst(count = 75, centerX, centerY, container) {
            const colors = ['#ff69b4', '#ffd700', '#8a2be2', '#ff4500', '#00ced1', '#ffffff', '#ff99e8', '#fff8dc'];
            // Prioritizing round and strip shapes for a realistic cracker look
            const shapes = ['round', 'strip', 'round']; 

            for (let i = 0; i < count; i++) {
                const color = colors[Math.floor(Math.random() * colors.length)];
                const shape = shapes[Math.floor(Math.random() * shapes.length)];
                const size = Math.random() * 6 + 4; // Size between 4 and 10 pixels
                createConfetti(centerX, centerY, color, size, shape, container);
            }
        }

        // --- Navigation Logic ---

        function nextPage() {
            if (currentPage < totalPages) {
                currentPage++;
            } else {
                // Wrap back to the start
                currentPage = 1;
            }
            renderPage();
        }

        function renderPage() {
            // Clear the existing content
            appContainer.innerHTML = '';
            // Clear the fireworks container on page change
            fireworksContainer.innerHTML = '';
            // Hide fireworks on non-firework pages
            fireworksContainer.classList.add('hidden');

            const content = document.createElement('div');
            content.className = 'flex flex-col items-center space-y-8';

            let nextButtonText = 'Continue >>';

            if (currentPage === 1) {
                // --- Page 1: Landing/Intro (Updated) ---
                content.innerHTML = `
                    <h1 class="text-4xl md:text-6xl title-font mb-4 text-center">A Very Special Wish...</h1>
                    <p class="text-xl md:text-2xl font-bold text-gray-700">It's time to celebrate the amazing</p>
                    <h2 class="text-6xl md:text-8xl font-black text-pink-600 animate-bounce title-font">${nickname}!</h2>
                    <p class="text-lg md:text-xl font-medium text-gray-500">The day is October 20th</p>
                    <div class="flex space-x-4">
                        <div class="candle"><div class="wick"></div><div class="flame"></div></div>
                        <div class="candle"><div class="wick"></div><div class="flame"></div></div>
                        <div class="candle"><div class="wick"></div><div class="flame"></div></div>
                    </div>
                `;
            } else if (currentPage === 2) {
                // --- Page 2: The Main Wish ---
                content.innerHTML = `
                    <h1 class="text-5xl md:text-7xl title-font mb-4 text-center">Happy Birthday ${nickname}!</h1>
                    <p class="text-2xl md:text-3xl font-semibold text-purple-700 leading-relaxed text-center">
                        To my dearest ${friendName} (the one and only ${nickname}),
                    </p>
                    <p class="text-lg text-gray-600 leading-relaxed text-center">
                        You light up every room you walk into, and I hope your special day is just as bright and wonderful as you are. May your year be filled with success, joy, and the most incredible adventures. You deserve all the happiness in the world.
                    </p>
                    <p class="text-xl font-bold text-pink-600 mt-4">Lots of love, always!</p>
                    <div class="text-4xl animate-spin-slow">🎉🎂🎁</div>
                    <div class="flex space-x-2">
                        <div class="candle"><div class="wick"></div><div class="flame"></div></div>
                        <div class="candle"><div class="wick"></div><div class="flame"></div></div>
                        <div class="candle"><div class="wick"></div><div class="flame"></div></div>
                        <div class="candle"><div class="wick"></div><div class="flame"></div></div>
                    </div>
                `;
            } else if (currentPage === 3) {
                // --- Page 3: Finale (Fireworks & Pop) ---
                fireworksContainer.classList.remove('hidden');
                content.innerHTML = `
                    <h1 class="text-5xl md:text-7xl title-font mb-4 text-center text-pink-700">It's Party Time!</h1>
                    <p class="text-2xl font-semibold text-gray-700 mb-4">Click below for a final surprise!</p>
                    <button id="pop-button" class="bg-gradient-to-r from-red-500 to-yellow-500 text-white font-bold py-4 px-8 rounded-full shadow-lg hover:shadow-xl transform hover:scale-105 transition duration-300 text-2xl animate-pulse">
                        POP THE CRACKER!
                    </button>
                    <p class="text-xl font-bold text-purple-700 mt-8">Happy 20th October!</p>
                `;
                nextButtonText = 'Start Over';

                // Attach pop effect handler
                setTimeout(() => {
                    const popButton = document.getElementById('pop-button');
                    if (popButton) {
                        popButton.addEventListener('click', () => {
                            // Get the button's position relative to the viewport
                            const buttonRect = popButton.getBoundingClientRect();
                            const centerX = buttonRect.left + buttonRect.width / 2;
                            const centerY = buttonRect.top + buttonRect.height / 2;

                            // Create the 'cracker' effect - launching multiple, tightly-timed bursts for realism
                            for (let i = 0; i < 8; i++) {
                                setTimeout(() => {
                                    // Launching 100 particles per burst, 8 times!
                                    launchConfettiBurst(100, centerX, centerY, fireworksContainer);
                                }, i * 80); 
                            }
                        });
                    }
                }, 0); // Ensure button exists before attaching listener
            }

            // Append page content
            appContainer.appendChild(content);

            // Create and append navigation button
            const navButton = document.createElement('button');
            navButton.onclick = nextPage;
            navButton.className = 'absolute bottom-4 right-4 bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 px-6 rounded-full shadow-lg transition duration-300 text-lg';
            navButton.textContent = nextButtonText;
            appContainer.appendChild(navButton);
        }


        // --- Initialization ---
        window.onload = function() {
            // Small setup to handle auth tokens for real-time apps, though not strictly needed here
            if (typeof __app_id !== 'undefined') { console.log('Firebase environment detected.'); }

            // Initial render
            renderPage();
        };

        // Make a periodic confetti background effect on all pages
        setInterval(() => {
            if (currentPage !== 3) {
                // Launch smaller bursts (10 particles) from the bottom of the card for subtle background effect
                const appRect = appContainer.getBoundingClientRect();
                const randomX = appRect.left + Math.random() * appRect.width;
                const randomY = appRect.top + appRect.height; 
                
                // Using fireworksContainer as the particle container
                launchConfettiBurst(10, randomX, randomY, fireworksContainer); 
            }
        }, 3000);

    </script>
</body>
</html>
